!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n=n||self).blobs2Animate={})}(this,function(n){"use strict";var c=function(){return(c=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var a in t=arguments[e])Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a]);return n}).apply(this,arguments)};function u(n){return{x:n.x,y:n.y,handleIn:c({},n.handleIn),handleOut:c({},n.handleOut)}}function l(e,r){for(var n=function(n){function t(n){return u(e[P(n,e.length)])}r({curr:u(e[n]),index:n,sibling:t,prev:function(){return t(n-1)},next:function(){return t(n+1)}})},t=0;t<e.length;t++)n(t)}function s(n,t){var e=[];return l(n,function(n){e.push(t(n))}),e}function i(n,t){return n.x===t.x&&n.y===t.y}function d(n,t){var e=t.x-n.x,n=-t.y+n.y;return(e=Math.atan2(n,e))<0?Math.abs(e):2*Math.PI-e}function h(n,t){return{x:n.x+t.length*Math.cos(t.angle),y:n.y+t.length*Math.sin(t.angle)}}function f(n,t){return{angle:d(n,t),length:Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}}function g(n,t,e){return t+n*(e-t)}function p(n,t){for(var e=2*Math.PI/n,r=[],a=0;a<n;a++){var i=t(),o=Math.sin(a*e),u=Math.cos(a*e);r.push({x:.5+o*i,y:.5+u*i,handleIn:{angle:0,length:0},handleOut:{angle:0,length:0}})}var l,h=4/3*Math.tan(e/4)/Math.sin(e/2)/2;return l=h,s(r,function(n){var t=n.curr,e=n.next,r=n.prev,n=d(r(),e());return{x:t.x,y:t.y,handleIn:{angle:n+Math.PI,length:l*S(t,r())},handleOut:{angle:n,length:l*S(t,e())}}})}function t(n){var t,e,r,a,i=(u=function(n){for(var t=2166136261,e=0;e<n.length;e++)t=Math.imul(t^n.charCodeAt(e),16777619);return function(){return t+=t<<13,t^=t>>>7,t+=t<<3,t^=t>>>17,(t+=t<<5)>>>0}}(u=String(n.seed)),t=u(),e=u(),r=u(),a=u(),function(){var n=(t>>>=0)+(e>>>=0)|0;return t=e^e>>>9,e=(r>>>=0)+(r<<3)|0,r=(r=r<<21|r>>>11)+(n=n+(a=(a>>>=0)+1|0)|0)|0,(n>>>0)/4294967296}),o=1/(1+n.randomness/10),u=p(3+n.extraPoints,function(){return(o+i()*(1-o))/2}),l=n.size;return s(u,function(n){n=n.curr;return n.x*=l,n.y*=l,n.handleIn.length*=l,n.handleOut.length*=l,n})}function e(n){return 1-Math.pow(n-1,2)}function v(a,n){function t(n){for(var t=0;t<i;t++){for(var e=0,r=0;r<i&&(e+=Math.pow(100*S(a[r],n[P(r+t,i)]),2),!(o<e));r++);e<=o&&(o=e,u=t,l=n)}}var e,r,i=a.length,o=1/0,u=0,l=[];return t(n),t(s(e=n,function(n){var t=n.index,t=(0,n.sibling)(e.length-t-1);return t.handleIn.angle+=Math.PI,t.handleOut.angle+=Math.PI,t})),r=u,s(l,function(n){var t=n.index;return(0,n.sibling)(t+r)})}function m(n,t){if(t.length<3)throw new Error("not enough points");if(n<t.length)throw new Error("cannot remove points");if(n===t.length)return t.slice();var a=[];l(t,function(n){var t,e=n.curr,r=n.next;a.push((t=e,n=r(),e=h(t,t.handleOut),r=h(n,n.handleIn),(S(t,n)+S(e,r)+t.handleOut.length+n.handleIn.length)/2))});for(var e=j(a,n-t.length),r=[],i=0;i<t.length;i++){var o=r[r.length-1]||t[i],u=t[P(i+1,t.length)];r.pop(),r.push.apply(r,F(e[i],o,u))}return n=r.pop(),r[0].handleIn=n.handleIn,r}function y(n,a){return s(n,function(n){var t=n.index,e=n.curr,r=n.prev,n=n.next;return 0===e.handleIn.length&&i(r(),e)&&(e.handleIn.angle=a[t].handleIn.angle),0===e.handleOut.length&&i(n(),e)&&(e.handleOut.angle=a[t].handleOut.angle),e})}function b(n){return s(n,function(n){var t=n.curr,e=n.prev,n=n.next,n=d(e(),n());return 0===t.handleIn.length&&(t.handleIn.angle=n+Math.PI),0===t.handleOut.length&&(t.handleOut.angle=n),t})}function x(n,t,e){var r=2*Math.PI,t=P(t,r),e=P(e,r);return Math.abs(t-e)>Math.PI&&(t<e?t+=r:e+=r),g(n,t,e)}function I(){return String(Math.random()).substr(2)}function O(n){var t=n.renderCache,e=n.currentFrames;if(0===e.length)return{renderCache:t,lastFrameId:null,points:[]};if(1===e.length){var r=e[0];return{renderCache:t,lastFrameId:r.id,points:r.initialPoints}}for(var a=e[0],i=e[1],o=2;o<e.length&&!(i.timestamp>n.timestamp);o++)a=e[o-1],i=e[o];var u=i===e[e.length-1];if(i.timestamp<n.timestamp&&u)return{renderCache:t,lastFrameId:i.id,points:i.initialPoints};var l,h=null===(l=t[a.id])||void 0===l?void 0:l.preparedStartPoints,u=null===(r=t[i.id])||void 0===r?void 0:r.preparedEndPoints;h&&u||(s=a.initialPoints,d=i.initialPoints,r=(l={rawAngles:!1,divideRatio:1}).divideRatio*Math.max(s.length,d.length),s=m(r,s),d=m(r,d),d=v(s,d),h=(d=[l.rawAngles?s:y(b(s),d),l.rawAngles?d:y(b(d),s)])[0],u=d[1],t[a.id]=t[a.id]||{},t[a.id].preparedStartPoints=h,t[i.id]=t[i.id]||{},t[i.id].preparedEndPoints=u);var s=(n.timestamp-a.timestamp)/(i.timestamp-a.timestamp),d=Math.max(0,Math.min(1,s)),s=i.timingFunction(d);return{renderCache:t,lastFrameId:(1===d?i:a).id,points:function(n,t,e){if(t.length!==e.length)throw new Error("must have equal number of points");for(var r=Math.min(1,Math.max(0,n)),a=[],i=0;i<t.length;i++)a.push(c(c({},C(n,t[i],e[i])),{handleIn:{angle:x(n,t[i].handleIn.angle,e[i].handleIn.angle),length:g(r,t[i].handleIn.length,e[i].handleIn.length)},handleOut:{angle:x(n,t[i].handleOut.angle,e[i].handleOut.angle),length:g(r,t[i].handleOut.length,e[i].handleOut.length)}}));return a}(s,h,u)}}function a(n,t,e){var r=typeof t;if("number"===r&&isNaN(t)&&(r="NaN"),!e.includes(r="object"===r&&null===t?"null":r))throw'"'+n+'" should have type "'+e.join("|")+'" but was "'+r+'".'}var M,o,w,F=function(n,t,e){if(n<2)return[t,e];var r=function(n,t,e){var r=u(t);r.handleOut.length*=n;var a=u(e);a.handleIn.length*=1-n;var i=h(t,t.handleOut),o=h(e,e.handleIn),t=h(r,r.handleOut),e=h(a,a.handleIn),o=C(n,i,o),t=C(n,t,o),o=C(1-n,e,o),n=C(n,t,o);return[r,{x:n.x,y:n.y,handleIn:f(n,t),handleOut:f(n,o)},a]}(1/n,t,e),t=r[0],e=r[1],r=r[2];return 2===n?[t,e,r]:function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),a=0,t=0;t<e;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)r[a]=i[o];return r}([t],F(n-1,e,r))},P=function(n,t){return(n%t+t)%t},S=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},C=function(n,t,e){return{x:g(n,t.x,e.x),y:g(n,t.y,e.y)}},r=function(t){return function(n){return Math.pow(2,-10*n)*Math.sin((n-t/4)*(2*Math.PI)/t)+1}},E={linear:function(n){return n},easeEnd:e,easeStart:function(n){return 1-e(1-n)},ease:function(n){return.5+.5*Math.sin(Math.PI*(n+1.5))},elasticEnd0:r(1),elasticEnd1:r(.64),elasticEnd2:r(.32),elasticEnd3:r(.16)},j=function(n,t){for(var e=n.map(function(){return 1}),r=n.slice(),a=0;a<t;a++){for(var i=0,o=1;o<r.length;o++)(r[o]>r[i]||r[o]===r[i]&&n[o]>n[i])&&(i=o);e[i]++,r[i]=n[i]/e[i]}return e},r=(M=function(e){return s(t(e.blobOptions),function(n){var t=n.curr;return t.x+=(null===(n=null==e?void 0:e.canvasOptions)||void 0===n?void 0:n.offsetX)||0,t.y+=(null===(n=null==e?void 0:e.canvasOptions)||void 0===n?void 0:n.offsetY)||0,t})},o=function(n){var r=new Path2D;return n.length<1||(r.moveTo(n[0].x,n[0].y),l(n,function(n){var t=n.curr,e=(0,n.next)(),n=h(t,t.handleOut),t=h(e,e.handleIn);r.bezierCurveTo(n.x,n.y,t.x,t.y,e.x,e.y)})),r},w=function(n,t){try{!function(n){a("blobOptions",n,["object"]);var t=n.seed,e=n.extraPoints,r=n.randomness,n=n.size;if(a("blobOptions.seed",t,["string","number"]),a("blobOptions.extraPoints",e,["number"]),e<0)throw'blobOptions.extraPoints is invalid "'+e+'".';if(a("blobOptions.randomness",r,["number"]),r<0)throw'blobOptions.randomness is invalid "'+r+'".';if(a("blobOptions.size",n,["number"]),n<0)throw'blobOptions.size is invalid "'+n+'".'}(n.blobOptions),e=n.canvasOptions,a("canvasOptions",e,["object","undefined"]),e&&(r=e.offsetX,e=e.offsetY,a("canvasOptions.offsetX",r,["number","undefined"]),a("canvasOptions.offsetY",e,["number","undefined"])),function(n){a("keyframe",n,["object"]);var t=n.delay,e=n.duration,r=n.timingFunction,n=n.callback;if(a("delay",t,["number","undefined"]),t&&t<0)throw'delay is invalid "'+t+'".';if(a("duration",e,["number"]),e&&e<0)throw'duration is invalid "'+e+'".';if(a("timingFunction",r,["string","undefined"]),r&&!E[r])throw'".timingFunction" is not recognized "'+r+'".';a("callback",n,["function","undefined"])}(n)}catch(n){throw"(blobs2): keyframe "+t+": "+n}var e,r},function(){function l(){return Date.now()-a}function t(){return 0!==r}function n(){t()&&(a+=l()-r,r=0)}function e(){t()||(r=l())}var h=[],s={},d={},r=0,a=0;return{renderFrame:function(){var n=O({renderCache:s,timestamp:t()?r:l(),currentFrames:h});return s=n.renderCache,n.lastFrameId&&d[n.lastFrameId]&&(d[n.lastFrameId](),delete d[n.lastFrameId]),o(n.points)},transition:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var e=0;e<n.length;e++)w(n[e],e);var r=function(n){var t=[];if(0===n.newFrames.length)return{newFrames:t};var e=O(n);if(null===e.lastFrameId){for(var r=n.shapeGenerator(n.newFrames[0]),a={x:0,y:0,handleIn:{angle:0,length:0},handleOut:{angle:0,length:0}},i=0,o=r;i<o.length;i++){var u=o[i];a.x+=u.x/r.length,a.y+=u.y/r.length}e.points=[a,a,a]}t.push({id:I(),initialPoints:e.points,timestamp:n.timestamp,timingFunction:E.linear,transitionSourceFrameIndex:-1,isSynthetic:!0});for(var l=0,h=0;h<n.newFrames.length;h++){var s,d=n.newFrames[h];d.delay&&(l+=d.delay,s=t[t.length-1],t.push({id:I(),initialPoints:s.initialPoints,timestamp:n.timestamp+l,timingFunction:E.linear,transitionSourceFrameIndex:h-1,isSynthetic:!0})),l+=d.duration,t.push({id:I(),initialPoints:n.shapeGenerator(d),timestamp:n.timestamp+l,timingFunction:E[d.timingFunction||"linear"],transitionSourceFrameIndex:h,isSynthetic:!1})}return{newFrames:t}}({renderCache:s,timestamp:l(),currentFrames:h,newFrames:n,shapeGenerator:M});h=r.newFrames,d={},s={};for(var a=0,i=h;a<i.length;a++){var o,u=i[a];u.isSynthetic||(o=n[u.transitionSourceFrameIndex].callback)&&(d[u.id]=o)}},play:n,pause:e,playPause:function(){(t()?n:e)()}}});n.canvasPath=r,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
